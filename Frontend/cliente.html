<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="shortcut icon" href="assets/img/pet.ico" type="image/x-icon">

        <!-- ===== BOX ICONS ===== -->
        <link href='https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css' rel='stylesheet'>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

        <!-- ===== CSS ===== -->
        <link rel="stylesheet" href="assets/css/cliente.css">

        <title>Agenda</title>
    </head>

    <!--- Nav --->

    <body id="body-pd">
        <header class="header" id="header">
            <div class="header__toggle">
                <i class='bx bx-menu' id="header-toggle"></i>
            </div>

            <div class="header__img">
                <img src="assets/img/perfil.jpg" alt="">
            </div>
        </header>

        <!-- Barra lateral-->

        <div class="l-navbar" id="nav-bar">
            <nav class="nav">
                <div>
                    <a href="#" class="nav__logo">                 
                        <i class='bx bx-layer nav__logo-icon'></i>
                        <span class="nav__logo-name">PETSHOP</span>
                    </a>
                    <hr />
                    <div class="nav__list">
                        <a href="index.html" class="nav__link">
                        <i class='bx bxs-calendar nav__icon'></i>
                            <span class="nav__name">Agenda</span>
                        </a>

                        <a href="caixa.html" class="nav__link">
                            <i class='bx bx-money nav__icon'></i>
                            <span class="nav__name">Caixa</span>
                        </a>
                        
                        <a href="cliente.html" class="nav__link active">
                            <i class='bx bxs-user nav__icon'></i>
                            <span class="nav__name">Clientes</span>
                        </a>

                        <a href="#" class="nav__link">
                            <span class="material-symbols-sharp nav__icon">pets</span>
                            <span class="nav__name">Animais</span>
                        </a>

                        <a href="#" class="nav__link">
                            <span class="material-symbols-sharp nav__icon">inventory</span>
                            <span class="nav__name">Estoque</span>
                        </a>
                        <hr />
                        <a href="#" class="nav__link">
                            <span class="material-symbols-sharp nav__icon">settings</span>
                            <span class="nav__name">Configurações</span>
                        </a>
                    </div>
                    
                </div>

                <a href="#" class="nav__link">
                    <i class='bx bx-log-out nav__icon' ></i>
                    <span class="nav__name">Log Out</span>
            </a>
            </nav>
        </div>
       
            

        <!--- Aplicando vue.js--->
        
        <div id="app"></div>
        
        <!--===== MAIN JS =====-->
        <script src="assets/js/main.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>

        <script>

            var app = new Vue({

            el: '#app',

                /* Conteudo */

            template: 
            ` <section>
            <div class="container">
                <div class="row">
                    <h1 class="title">Clientes</h1>
                    <button v-on:click="toggleModal" id="open-modal">Novo cliente</button>
                </div>
                    <div id="fade" class="hide"></div>
                    <div id="modal" class="hide">
                    <div class="modal-header">
                        <h2>Agendamento</h2>
                    </div>
                    <div class="modal-body">
                        <h5>Nome</h5>
                        <input v-model="nameC" type="text" placeholder="Nome do Cliente" list="faixa">
                        <datalist id="faixa">
                            <option value="">Nome</option>
                            <option>Cliente 1</option>
                            <option>Cliente 2</option>
                            <option>Cliente 3</option>
                        </datalist>
                        <h5>Pet</h5>
                        <input v-model="name" type="text" placeholder="Nome do Pet" list="faixa2">
                        <datalist id="faixa2">
                            <option value="">Nome</option>
                            <option>Pet</option>
                            <option>Petzinho</option>
                            <option>Auau</option>
                        </datalist>
                        <h5>Raça</h5>
                        <input v-model="raca" type="text" placeholder="Raça do animal" list="faixa4">
                        <datalist id="faixa4">
                            <option value="">Nome</option>
                            <option>Raça1</option>
                            <option>Raça2</option>
                            <option>Raça3</option>
                        </datalist>
                        <h5>Serviço</h5>
                        <input v-model="service" type="text" placeholder="Serviço" list="faixa3">
                        <datalist id="faixa3">
                            <option value="">Nome</option>
                            <option>Banho</option>
                            <option>Tosa</option>
                            <option>Banho e Tosa</option>
                        </datalist>
                        <div class="modal-footer">
                            <button v-on:click="toggleModal" v-on:click="addPet" type="submit" class="confirm">Confirmar</button>
                            <button v-on:click="toggleModal" id="close-modal">Fechar</button>
                        </div>
                    </div>
                </div>
                    <div class="content">
                        <div class="main-content">
                            <div class="boxHeader">
                                <h1 class="boxTitle">Lista de Clientes</h1>
                            </div>
                            <div class="boxContent">
                                <hr />
                                <main class="table">
                                    <section class="table__header">
                                        <div class="input-group" >
                                            <input v-on:click="searchTable" type="search" placeholder="Pesquisar">
                                            <img src="assets/img/search.png" alt="">
                                        </div>
                                    </section>
                                    <section class="table__body">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th> ID <span class="icon-arrow">&UpArrow;</span></th>
                                                    <th> Nome <span class="icon-arrow">&UpArrow;</span></th>
                                                    <th> Pets <span class="icon-arrow">&UpArrow;</span></th>
                                                    <th> Telefone <span class="icon-arrow">&UpArrow;</span></th>
                                                    <th> CPF <span class="icon-arrow">&UpArrow;</span></th>
                                                    <th> Ações <span class="icon-arrow">&UpArrow;</span></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td> 1 </td>
                                                    <td class="nomeImg"> <img src="assets/img/perfil.jpg" alt="">Fubuki</td>
                                                    <td> 2</td>
                                                    <td> 4002-8922 </td>
                                                    <td> 111.222.333-44</td>
                                                    <td><button class="edit"><i class='bx bx-edit-alt'></i></button> <button class="delete"><i class='bx bx-trash' ></i></button></td>
                                                </tr>
                                                <tr>
                                                    <td> 2 </td>
                                                    <td class="nomeImg"><img src="assets/img/isagi.jpg" alt=""> Isagi Yoichi</td>
                                                    <td> 1</td>
                                                    <td> 1111-3333 </td>
                                                    <td>999.888.666-77</td>
                                                    <td><button class="edit"><i class='bx bx-edit-alt'></i></button> <button class="delete"><i class='bx bx-trash' ></i></button></td>
                                                </tr>
                                                <tr>
                                            </tbody>
                                        </table>
                                    </section>
                                </main>
                                <!--<h2>Nenhum agendamento por aqui</h2>-->
                                <!--<img class="gif" src="assets/img/House searching_purple.gif" alt="searchGif">-->
                            </div>
                        </div>
                    </div>
                </div>
                </section>`
            ,


            data: {
                clientes: [] 
            },
            mounted(){
                this.getCliente();
            }
            ,

            methods: {
                /* Metodo modal */
                getCliente(){
                    axios.get('http://localhost:88/listar')
                    .then(response=> {
                        this.clientes = response.data
                    }).catch(error => {
                            console.log(error);
                        });
                },
                toggleModal(){
                    const openModalButton = document.querySelector("#open-modal");
                    const closeModalButton = document.querySelector("#close-modal");
                    const modal = document.querySelector("#modal");
                    const fade = document.querySelector("#fade");
                    
                    modal.classList.toggle("hide");
                    fade.classList.toggle("hide");
                    
                },

                searchTable(){
                    /* ======== Search ====== */

                    const search = document.querySelector('.input-group input'),
                        table_rows = document.querySelectorAll('tbody tr'),
                        table_headings = document.querySelectorAll('thead th');

                    // 1. Searching for specific data of HTML table
                    search.addEventListener('input', searchTable);

                    function searchTable() {
                        table_rows.forEach((row, i) => {
                            let table_data = row.textContent.toLowerCase(),
                                search_data = search.value.toLowerCase();

                            row.classList.toggle('hide', table_data.indexOf(search_data) < 0);
                            row.style.setProperty('--delay', i / 25 + 's');
                        })

                        document.querySelectorAll('tbody tr:not(.hide)').forEach((visible_row, i) => {
                            visible_row.style.backgroundColor = (i % 2 == 0) ? 'transparent' : '#0000000b';
                        });
                    }

                    // 2. Sorting | Ordering data of HTML table

                    table_headings.forEach((head, i) => {
                        let sort_asc = true;
                        head.onclick = () => {
                            table_headings.forEach(head => head.classList.remove('active'));
                            head.classList.add('active');

                            document.querySelectorAll('td').forEach(td => td.classList.remove('active'));
                            table_rows.forEach(row => {
                                row.querySelectorAll('td')[i].classList.add('active');
                            })

                            head.classList.toggle('asc', sort_asc);
                            sort_asc = head.classList.contains('asc') ? false : true;

                            sortTable(i, sort_asc);
                        }
                    })


                    function sortTable(column, sort_asc) {
                        [...table_rows].sort((a, b) => {
                            let first_row = a.querySelectorAll('td')[column].textContent.toLowerCase(),
                                second_row = b.querySelectorAll('td')[column].textContent.toLowerCase();

                            return sort_asc ? (first_row < second_row ? 1 : -1) : (first_row < second_row ? -1 : 1);
                        })
                            .map(sorted_row => document.querySelector('tbody').appendChild(sorted_row));
                    }

                }
            }
            })
        </script>
    </body>
</html>